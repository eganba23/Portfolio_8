---
title: "Creating Data"
author: "Benjamin Egan"
output: html_document
---

#### Created 4/3/25

```{r setup, include = FALSE}

library(tidyverse) 
library(ggplot2)
library(emmeans)
library(haven)

```

## Objective

As I mentioned in piece 3, I serve as a teaching assistant for the undergraduate Research Methods in psychology course at Wake Forest University. They are required to write a final paper, for which they need to write up and analyze a 2x2 experiment. As a TA, I have to create the data for the experiment. Since it's a 2x2 between subjects with at least 100 participants, this would be incredibly difficult. Luckily I walked through module 13 on simulating data, and should be able to create the data.

The basic function I'll need to use is rnorm(). This will let me randomly generate a sample of a normal distribution. I'm starting and making sure I can actually generate the data.


```{r base rnorm}

set.seed(123)

base_rnorm <- rnorm(100, mean = 50, sd = 5)

first_attempt <- data.frame(id = 1:100, base_rnorm)

                                      
data.frame(first_attempt) %>%
ggplot(
 aes(x=base_rnorm)
)+
  theme_bw()+
  geom_histogram(binwidth=2,color="black", fill="blue") +
  labs(
    title = "Look, I can create data!",
    x = NULL, 
    y = NULL
    )

```

My plan is to create four different samples, one for each group. I then will join them to create a large dataset. This way I can control the main effects and interactions.

The experiment calls for two variables, Sugar (sugar/no sugar) and Caffeine (caffeine/no caffeine), and the DV is reported distance to an object.

## Creating the groups

### Sugar and caffeine
```{r sugar and caffeine}

set.seed(101)

Distance <- rnorm(30, mean = 240, sd = 23.03)

group1 <- data.frame(id = 1:30, Sugar = 1, Caffeine = 1, round(Distance,0))


```

Using round() allowed me to make distance a whole number

### No sugar and caffeine
```{r no sugar and caffeine}

set.seed(103)

Distance <- rnorm(30, mean = 265, sd = 21.3)

group3 <- data.frame(id = 61:90, Sugar = 0, Caffeine = 1, round(Distance,0))


```

### Sugar and no caffeine
```{r sugar and no caffeine}

set.seed(102)

Distance <- rnorm(30, mean = 300, sd = 20.1)

group2 <- data.frame(id = 31:60, Sugar = 1, Caffeine = 0, round(Distance,0))

```



### No sugar and no caffeine
```{r neither sugar and caffeine}

set.seed(104)

Distance <- rnorm(30, mean = 300, sd = 23.05)

group4 <- data.frame(id = 91:120, Sugar = 0, Caffeine = 0, round(Distance,0))

```

## Joining the groups

```{r join groups}

group1and2 <- group1 %>% full_join(group2)

group3and4 <- group3 %>% full_join(group4)

lab_12_data <- group1and2 %>% full_join(group3and4)

lab_12_data <- lab_12_data %>% 
  rename(Distance = round.Distance..0.)

write_sav(lab_12_data, "class_data.sav")

Test_data <- read_sav("class_data.sav")



```

lab_12_data is a data frame that includes an ID number, if they had sugar or caffeine, and a distance score.

```{r anova test}

#view(lab_12_data)

hello <- Test_data %>%
  mutate(Sugar1 = case_when(
    Sugar == 0 ~ "No Sugar",
    Sugar == 1 ~ "Sugar"
  ))

hello <- hello %>%
  mutate(Caffeine1 = case_when(
    Caffeine == 0 ~ "No Caffeine",
    Caffeine == 1 ~ "Caffeine"
  ))


aov(Distance ~ Sugar1 * Caffeine1, hello) %>%
summary()

hello %>%
  ggplot(aes(
    x = Sugar1,
    y = Distance,
    group = Caffeine1,
    color = Caffeine1
  ))+
  geom_line()

```



## Creating the groups part 2

### Sugar and caffeine
```{r sugar and caffeine 1}

set.seed(101)

Distance <- rnorm(30, mean = 235, sd = 23.03)

group1a <- data.frame(id = 1:30, Sugar = 1, Caffeine = 1, round(Distance,0))


```

Using round() allowed me to make distance a whole number

### Sugar and no caffeine
```{r no sugar and caffeine 1}

set.seed(103)

Distance <- rnorm(30, mean = 280, sd = 21.3)

group3a <- data.frame(id = 61:90, Sugar = 1, Caffeine = 0, round(Distance,0))


```

### No Sugar and no caffeine
```{r no sugar and no caffeine 1}

set.seed(102)

Distance <- rnorm(30, mean = 275, sd = 20.1)

group2a <- data.frame(id = 31:60, Sugar = 0, Caffeine = 0, round(Distance,0))

```



### No sugar and caffeine
```{r no sugar and caffeine 1}

set.seed(104)

Distance <- rnorm(30, mean = 250, sd = 23.05)

group4a <- data.frame(id = 91:120, Sugar = 0, Caffeine = 1, round(Distance,0))

```

## Joining the groups

```{r join groups 1}

group1and2a <- group1a %>% full_join(group2a)

group3and4a <- group3a %>% full_join(group4a)

lab_12_data_test <- group1and2a %>% full_join(group3and4a)

lab_12_data_test <- lab_12_data_test %>% 
  rename(Distance = round.Distance..0.)

write_sav(lab_12_data_test, "class_data_official.sav")

Test_data1 <- read_sav("class_data_official.sav")



```

lab_12_data is a data frame that includes an ID number, if they had sugar or caffeine, and a distance score.

```{r anova test 1}

#view(lab_12_data)

helloa <- Test_data1 %>%
  mutate(Sugar1 = case_when(
    Sugar == 0 ~ "No Sugar",
    Sugar == 1 ~ "Sugar"
  ))

helloa <- helloa %>%
  mutate(Caffeine1 = case_when(
    Caffeine == 0 ~ "No Caffeine",
    Caffeine == 1 ~ "Caffeine"
  ))


aov(Distance ~ Sugar1 * Caffeine1, helloa) %>%
summary()

helloa %>%
  ggplot(aes(
    x = Sugar1,
    y = Distance,
    group = Caffeine1,
    color = Caffeine1
  ))+
  geom_line()

```

